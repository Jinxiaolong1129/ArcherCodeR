
[notice] A new release of pip is available: 25.1.1 -> 25.2
[notice] To update, run: pip install --upgrade pip

[notice] A new release of pip is available: 25.1.1 -> 25.2
[notice] To update, run: pip install --upgrade pip
  DEPRECATION: Legacy editable install of verl==0.1 from file:///data/xuandong_zhao/mnt/xiaolong/ArcherCodeR (setup.py develop) is deprecated. pip 25.3 will enforce this behaviour change. A possible replacement is to add a pyproject.toml or enable --use-pep517, and use setuptools >= 64. If the resulting installation is not behaving as expected, try using --config-settings editable_mode=compat. Please consult the setuptools documentation for more information. Discussion can be found at https://github.com/pypa/pip/issues/11457

[notice] A new release of pip is available: 25.1.1 -> 25.2
[notice] To update, run: pip install --upgrade pip
+ unset ROCR_VISIBLE_DEVICES
+ ulimit -n 1048576
+ echo 'Warning: Could not set ulimit for open files (insufficient permissions)'
+ export VLLM_ATTENTION_BACKEND=FLASH_ATTN
+ VLLM_ATTENTION_BACKEND=FLASH_ATTN
+ export PYTORCH_CUDA_ALLOC_CONF=expandable_segments:False
+ PYTORCH_CUDA_ALLOC_CONF=expandable_segments:False
+ export VLLM_ALLOW_LONG_MAX_MODEL_LEN=1
+ VLLM_ALLOW_LONG_MAX_MODEL_LEN=1
+ export VLLM_ENGINE_ITERATION_TIMEOUT_S=1000000000
+ VLLM_ENGINE_ITERATION_TIMEOUT_S=1000000000
+ export VLLM_WORKER_MULTIPROC_METHOD=spawn
+ VLLM_WORKER_MULTIPROC_METHOD=spawn
+ export HF_TOKEN=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
+ HF_TOKEN=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
+ export WANDB_API_KEY=5c271ef60b4c4753def92be733cf80487f0c7e78
+ WANDB_API_KEY=5c271ef60b4c4753def92be733cf80487f0c7e78
+ export NCCL_DEBUG=INFO
+ NCCL_DEBUG=INFO
+ export NCCL_DEBUG_SUBSYS=ALL
+ NCCL_DEBUG_SUBSYS=ALL
+ export NCCL_IB_TIMEOUT=200
+ NCCL_IB_TIMEOUT=200
+ export NCCL_TIMEOUT=300000
+ NCCL_TIMEOUT=300000
+ '[' -f .env ']'
+ echo 'Warning: .env file not found. Continuing without loading .env'
+ echo 'Step 1: Downloading datasets...'
+ /data/xuandong_zhao/anaconda3/envs/archer/bin/python tools/download_datasets.py
+ echo 'Step 2: Starting Ray cluster...'
+ bash ./tools/start_ray_single.sh
+ echo 'Step 3: Starting training...'
+ bash ./scripts/train/run_archer_qwen2.5_1.5b_code_optimized.sh
+ nnodes=1
+ project_name=ArcherCodeR
+ exp_name=Archer-Qwen2.5-1.5B-Fast
+ adv_estimator=grpo
+ use_kl_in_reward=False
+ kl_coef=0.0
+ use_kl_loss=True
+ kl_loss_coef=0.001
+ kl_loss_type=low_var_kl
+ clip_ratio_low=0.2
+ clip_ratio_high=0.2
+ loss_agg_mode=token-mean
+ max_prompt_length=1024
+ max_response_length=8192
+ enable_overlong_buffer=False
+ overlong_buffer_len=16
+ overlong_penalty_factor=1.0
+ v_max_response_length=8192
+ train_prompt_bsz=16
+ gen_prompt_bsz=16
+ train_prompt_mini_bsz=8
+ MODEL_PATH=deepseek-ai/DeepSeek-R1-Distill-Qwen-1.5B
+ CKPTS_DIR=./output/ArcherCodeR/Archer-Qwen2.5-1.5B-Fast
+ data_dir=./data
+ TRAIN_FILE=./data/train/archercoder-1.5b-train.json
+ TEST_FILE=./data/test/livecodebench_v5.json
+ n_resp_per_prompt=4
+ temperature=1.0
+ top_p=1.0
+ top_k=-1
+ v_n=4
+ v_temperature=0.8
+ v_top_p=1.0
+ v_top_k=-1
+ sp_size=1
+ gen_tp=1
+ use_dynamic_bsz=False
+ micro_batch_size_per_gpu=1
+ actor_ppo_max_token_len=9216
+ infer_ppo_max_token_len=9216
+ offload=False
+ use_token_entropy_separate=True
+ token_entropy_quantile=0.8
+ high_entropy_kl_loss_scale_coef=0.0
+ low_entropy_clip_ratio_low=0.2
+ low_entropy_clip_ratio_high=0.2
+ high_entropy_clip_ratio_low=0.5
+ high_entropy_clip_ratio_high=0.5
+ use_overlong_filter=False
+ echo 'üöÄ OPTIMIZED CONFIGURATION:'
+ echo 'üìè Max prompt length: 1024'
+ echo 'üìè Max response length: 8192'
+ echo 'üì¶ Batch size: 16'
+ echo 'üî¢ Responses per prompt: 4'
+ echo '‚ö° Tensor parallel: 1'
+ echo 'üéØ Total tokens per batch: 524288'
+ mkdir -p ./output/ArcherCodeR/Archer-Qwen2.5-1.5B-Fast
+ mkdir -p ./output/ArcherCodeR/Archer-Qwen2.5-1.5B-Fast/eval
+ tee ./output/ArcherCodeR/Archer-Qwen2.5-1.5B-Fast/ArcherCodeR_Archer-Qwen2.5-1.5B-Fast_grpo.log
+ python -m dapo.main_dapo data.train_files=./data/train/archercoder-1.5b-train.json data.val_files=./data/test/livecodebench_v5.json data.prompt_key=prompt data.filter_overlong_prompts=True data.truncation=error data.max_prompt_length=1024 data.max_response_length=8192 data.gen_batch_size=16 data.train_batch_size=16 actor_rollout_ref.rollout.n=4 algorithm.adv_estimator=grpo algorithm.use_kl_in_reward=False algorithm.kl_ctrl.kl_coef=0.0 actor_rollout_ref.actor.use_kl_loss=True actor_rollout_ref.actor.kl_loss_coef=0.001 actor_rollout_ref.actor.kl_loss_type=low_var_kl actor_rollout_ref.actor.clip_ratio_low=0.2 actor_rollout_ref.actor.clip_ratio_high=0.2 actor_rollout_ref.actor.clip_ratio_c=10.0 actor_rollout_ref.model.use_remove_padding=True actor_rollout_ref.actor.use_dynamic_bsz=False actor_rollout_ref.actor.ppo_micro_batch_size_per_gpu=1 +actor_rollout_ref.actor.use_token_entropy_separate=True +actor_rollout_ref.actor.high_entropy_kl_loss_scale_coef=0.0 +actor_rollout_ref.actor.low_entropy_clip_ratio_low=0.2 +actor_rollout_ref.actor.low_entropy_clip_ratio_high=0.2 +actor_rollout_ref.actor.high_entropy_clip_ratio_low=0.5 +actor_rollout_ref.actor.high_entropy_clip_ratio_high=0.5 actor_rollout_ref.ref.log_prob_use_dynamic_bsz=False actor_rollout_ref.ref.log_prob_micro_batch_size_per_gpu=1 actor_rollout_ref.rollout.log_prob_use_dynamic_bsz=False actor_rollout_ref.rollout.log_prob_micro_batch_size_per_gpu=1 actor_rollout_ref.actor.ppo_max_token_len_per_gpu=9216 actor_rollout_ref.ref.log_prob_max_token_len_per_gpu=9216 actor_rollout_ref.rollout.log_prob_max_token_len_per_gpu=9216 actor_rollout_ref.model.path=deepseek-ai/DeepSeek-R1-Distill-Qwen-1.5B actor_rollout_ref.model.enable_gradient_checkpointing=True actor_rollout_ref.actor.optim.lr=1e-6 actor_rollout_ref.actor.optim.lr_warmup_steps=10 actor_rollout_ref.actor.optim.weight_decay=0.1 actor_rollout_ref.actor.ppo_epochs=3 actor_rollout_ref.actor.ppo_mini_batch_size=8 actor_rollout_ref.actor.fsdp_config.param_offload=False actor_rollout_ref.actor.fsdp_config.optimizer_offload=False actor_rollout_ref.actor.entropy_coeff=0 actor_rollout_ref.actor.grad_clip=1.0 actor_rollout_ref.actor.loss_agg_mode=token-mean actor_rollout_ref.actor.ulysses_sequence_parallel_size=1 actor_rollout_ref.rollout.gpu_memory_utilization=0.75 actor_rollout_ref.rollout.tensor_model_parallel_size=1 actor_rollout_ref.rollout.enable_chunked_prefill=True actor_rollout_ref.rollout.max_num_batched_tokens=9216 actor_rollout_ref.rollout.max_model_len=9216 actor_rollout_ref.rollout.temperature=1.0 actor_rollout_ref.rollout.top_p=1.0 actor_rollout_ref.rollout.top_k=-1 actor_rollout_ref.rollout.val_kwargs.temperature=0.8 actor_rollout_ref.rollout.val_kwargs.top_p=1.0 actor_rollout_ref.rollout.val_kwargs.top_k=-1 actor_rollout_ref.rollout.val_kwargs.do_sample=True actor_rollout_ref.rollout.val_kwargs.n=4 +actor_rollout_ref.rollout.val_kwargs.response_length=8192 actor_rollout_ref.ref.fsdp_config.param_offload=False actor_rollout_ref.ref.ulysses_sequence_parallel_size=1 actor_rollout_ref.actor.fsdp_config.fsdp_size=-1 reward_model.reward_manager=wizard reward_model.overlong_buffer.enable=False reward_model.overlong_buffer.len=16 reward_model.overlong_buffer.penalty_factor=1.0 'trainer.logger=[console,wandb]' trainer.project_name=ArcherCodeR trainer.experiment_name=Archer-Qwen2.5-1.5B-Fast trainer.n_gpus_per_node=8 trainer.nnodes=1 trainer.balance_batch=False trainer.val_before_train=False trainer.test_freq=-1 trainer.save_freq=10 trainer.total_epochs=10 trainer.default_local_dir=./output/ArcherCodeR/Archer-Qwen2.5-1.5B-Fast trainer.resume_mode=auto +trainer.validation_data_dir=./output/ArcherCodeR/Archer-Qwen2.5-1.5B-Fast/eval +trainer.enable_overlong_filter=False +trainer.rejection_sample=True
